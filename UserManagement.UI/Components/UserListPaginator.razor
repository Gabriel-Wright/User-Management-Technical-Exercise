<div class="d-flex justify-content-between align-items-center mt-3">
    <div>
        <button class="btn btn-outline-primary me-2" @onclick="PrevPage" disabled="@IsFirstPage">Previous</button>
        <span>Page @CurrentPage of @TotalPages</span>
        <button class="btn btn-outline-primary ms-2" @onclick="NextPage" disabled="@IsLastPage">Next</button>
    </div>

    <div class="d-flex align-items-center">
        <label class="me-2">Sort by:</label>
        <select class="form-select w-auto" @bind="SelectedSortField">
            <option value="id">Id</option>
            <option value="forename">Forename</option>
            <option value="surname">Surname</option>
            <option value="email">Email</option>
        </select>

        <select class="form-select w-auto ms-2" @bind="SelectedSortDirection">
            <option value="false">Ascending</option>
            <option value="true">Descending</option>
        </select>

        <button class="btn btn-primary ms-2" @onclick="ApplySort">Apply</button>
    </div>
</div>

@code {
    [Parameter] public int CurrentPage { get; set; } = 1;
    [Parameter] public int TotalPages { get; set; } = 1;
    [Parameter] public EventCallback<int> OnPageChanged { get; set; }

    [Parameter] public string SortField { get; set; } = "id";
    [Parameter] public bool Descending { get; set; } = false;
    [Parameter] public EventCallback<(string sortBy, bool sortDesc)> OnSortChanged { get; set; }

    private string SelectedSortField { get; set; } = "id";
    private string SelectedSortDirection { get; set; } = "false";

    private bool IsDescending => SelectedSortDirection == "true";

    private bool IsFirstPage => CurrentPage <= 1;
    private bool IsLastPage => CurrentPage >= TotalPages;

    protected override void OnParametersSet()
    {
        SelectedSortField = SortField;
        SelectedSortDirection = Descending ? "true" : "false";
    }

    private async Task PrevPage() => await ChangePage(CurrentPage - 1);
    private async Task NextPage() => await ChangePage(CurrentPage + 1);

    private async Task ChangePage(int newPage)
    {
        if (newPage < 1 || newPage > TotalPages) return;
        await OnPageChanged.InvokeAsync(newPage);
    }

    private async Task ApplySort()
    {
        await OnSortChanged.InvokeAsync((SelectedSortField, IsDescending));
    }
}